<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Tutorial: Hello dgrid!</title>
    <!-- this configuration assumes that the dgrid package is located
         on the filesystem as a sibling to the dojo package -->
    <script src="../dojo/dojo.js"
            data-dojo-config="async: true"></script>
    <script>
        var grid;


        require(["dojo/_base/declare", "dojo/request", "dojo/store/Memory", "dgrid/OnDemandGrid", "dgrid/Selection"],
                function (declare, request, Memory, OnDemandGrid, Selection) {
                    request("hof-batting.json", {
                        handleAs: "json"
                    }).then(function (response) {
                                                    // Once the response is received, build an in-memory store
                                                    // with the data
                                                    var store = new Memory({ data: response });

                                                    var CustomGrid = declare([ OnDemandGrid, Selection ]);

                                                    // Create an instance of OnDemandGrid referencing the store
                                                    var grid = new CustomGrid(
                                                            {

                                                                store: store,
                                                                columns: {
                                                                    first: "First Name",
                                                                    last: "Last Name",
                                                                    totalG: "Games Played"
                                                                },
                                                                selectionMode: "single"

                                                            }, "grid");

                                                    grid.startup();
                                                });
                });




        require(["dgrid/Grid", "dojo/domReady!"], function(Grid) {

            grid.on("dgrid-select", function(event) {
                console.log("selected: " + event.type);

                var first=event.rows[0].data.first;
                var lastname=event.rows[0].data.last;

                var key=document.getElementById('key').value=first;
                var value=document.getElementById('value').value=lastname;
            });

            grid.on(".dgrid-row:click", function(event){
                var row = grid.row(event);
                console.log("Row clicked:", row.id);
                var el=document.getElementById("details");
                el.innerHTML="row: " + row.id + ", " + row.data.first;
            });

            grid.renderArray(data);
        });

        function display(keyname, valname) {
            var key=document.getElementById(keyname).value;
            var value=document.getElementById(valname).value;
            console.log("key=" + key + ", value=" + value);

            data.push({first: "new", last: "last", age: 66});
            // grid.renderArray(data);

        }
    </script>
</head>
<body>
<div id="grid"></div>
<div id="details">hello</div>
<form id="add" onsubmit="display('key', 'value')">
    <label for='key'>Key: </label>
    <input id='key' name="Key" autofocus/>
    <label for='value'>Value:</label>
    <input id='value' name="Value"/>
    <input type='submit' name="Add" value="Add"/>
</form>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>JDG client</title>
    <!-- this configuration assumes that the dgrid package is located
         on the filesystem as a sibling to the dojo package -->
    <script src="../dojo/dojo.js"
            data-dojo-config="async: true"></script>

</head>
<body>
<script>

    require(["dojo/store/Memory", "dojo/store/Observable", "dgrid/Grid", "dgrid/Selection",
                "dgrid/OnDemandGrid", "dojo/domReady!"],
            function(Memory, Observable, Grid, Selection, OnDemandGrid) {

                var employees=[
                    {first: "Bela", last: "Ban", age: 48},
                    {first: "Michelle", last: "Ban", age: 12},
                    {first: "Nicole", last: "Ban", age: 9},
                    {first: "Jeannette", last: "Ban", age: 45},
                    {first: "Marco", last: "Furini", age: 48}
                ]

                var store=new Memory({data:employees, idProperty: "first"});
                store=Observable(store);

                var grid = new OnDemandGrid({
                                                store: store,
                                                columns: {
                                                    first: "First Name",
                                                    last: "Last Name",
                                                    age: "Age"
                                                },
                                                selectionMode: "single"
                                            }, "grid");

                grid.on("dgrid-select", function(event) {
                    console.log("selected: " + event.type);

                    var first=event.rows[0].data.first;
                    var lastname=event.rows[0].data.last;

                    var key=document.getElementById('key').value=first;
                    var value=document.getElementById('value').value=lastname;
                });

                grid.on(".dgrid-row:click", function(event){
                    var row = grid.row(event);
                    console.log("Row clicked:", row.id);
                    var el=document.getElementById("details");
                    el.innerHTML="row: " + row.id + ", " + row.data.first;
                });
            });


    function display(keyname, valname) {
        var key=document.getElementById(keyname).value;
        var value=document.getElementById(valname).value;
        console.log("key=" + key + ", value=" + value);

        store.add({first: key, last: value, age: 66});
        var bela=store.get("Bela");
        bela.age=30;
        store.put(bela);
    }
</script>



<div id="griddie"></div>
<div id="details">hello</div>
<div id="message">message here...</div>
<p/>
<form id="add" onsubmit="display('key', 'value')">
    <label for='key'>Key: </label>
    <input id='key' name="Key" autofocus/>
    <label for='value'>Value:</label>
    <input id='value' name="Value"/>
    <input type='submit' name="Add" value="Add"/>
</form>
</body>
</html>
